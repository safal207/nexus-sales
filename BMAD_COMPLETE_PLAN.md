# BMAD COMPLETE PLAN — ConsciousFunnels

## 1. Цель и KPI
- **Цель MVP:** запустить открытую платформу для эмпатичных воронок продаж с AI-инсайтами и Stripe-интеграцией.
- **KPI запуска:**
  - 100 пилотных пользователей в течение 30 дней после релиза.
  - ≥60% создают и публикуют первую воронку за 14 дней.
  - ≥15% переходят на платный тариф в течение 45 дней.
  - Среднее время до первой продажи < 10 минут после публикации воронки.

## 2. Дорожная карта (6 недель)
| Неделя | Цели | Основные задачи | Ответственные |
| --- | --- | --- | --- |
| 1 | Укрепление инфраструктуры | Настроить `outputFileTracingRoot`, вынести проект с OneDrive, стабилизировать dev/build | DevOps, Frontend |
| 2 | Конструктор и базовые CRUD | Переписать Auth/Products API с учётом JWT и mock DB, исправить импорты/типы, реализовать drag&drop канвас | Frontend, Backend |
| 3 | AI и аналитика | Внедрить очередь AI, добавить `/api/analytics/insights`, настроить сбор событий | Data/AI, Backend |
| 4 | Платежи и онбординг | Подключить Stripe, Email-уведомления, мастер онбординга, тест-кейсы | Backend, Product |
| 5 | Тестирование и документация | Playwright e2e, smoke suite, гайды по развёртыванию, подготовка маркетинговых материалов | QA, Tech Writing |
| 6 | Пре-ланч и GTM | Пилотные созвоны, финальная оптимизация, запуск лэндинга/PR, создание поддерживающего контента | Product, Marketing |

## 3. Бэклог по блокам
**Архитектура и DevOps**
- Переместить репозиторий вне OneDrive, настроить права на `.next`.
- CI: lint → type-check → build; добавить GitHub Actions.
- Документация по self-hosted (Docker Compose).

**Backend (Clojure/Next API)**
- Рефактор Auth/Products API → использовать общую in-memory DB, вынести типы.
- Создать `/api/analytics/insights`, `/api/emotions/predict`, `/api/emotions/journey`.
- Добавить слой валидации (zod / Malli) + единый ответ об ошибках.

**Frontend (Next.js)**
- Исправить импорты (`RegisterForm`, `ProductForm`, `AuthContext`).
- Реализовать drag&drop конструктор (dnd-kit), предпросмотр, мобильную версию.
- Дашборд: Recharts, таблица продуктов, карточки KPI.

**AI**
- Адаптер Hugging Face + кэширование, лимиты.
- Пайплайн анализа эмоций: очереди, метрики, логирование.
- Набор эмпатичных шаблонов, «AI-копирайтер».

**Платежи**
- Stripe Checkout + webhook → создание `orders`.
- Resend/SMTP уведомления (клиенту и владельцу воронки).
- Настройки продуктов/подписок в админке.

**Документация и запуск**
- Обновить README и `README_NEW` (установка, скрипты, структура монорепо).
- Подготовить FAQ, onboarding PDF, видео-гайд.
- Маркетинговый лэндинг, сравнительная таблица с конкурентами.

## 4. Зависимости и риски
| Риск | Вероятность | Влияние | План действий |
| --- | --- | --- | --- |
| Ограничения Hugging Face | Средняя | Высокое | Кэширование, лимит запросов, подготовить альтернативную модель (DistilRoBERTa) |
| Ошибки Next из-за OneDrive | Высокая | Высокое | Немедленно перенести репозиторий, зафиксировать пути в `next.config.js` |
| Отсутствие тестов | Высокая | Среднее | Создать smoke + e2e, добавить в CI |
| UX сложность | Средняя | Среднее | Провести 3 UX-интервью, улучшить онбординг |
| Зависимость от Stripe | Низкая | Среднее | Поддержать PayPal/Manual fallback позже |

## 5. Метрики прогресса
- Weekly scorecard: % выполненных задач по блокам, количество багов, покрытие тестами.
- Burndown диаграмма по спринтам.
- NPS пилотов каждую неделю (быстрый опрос в Slack/Notion).

## 6. Коммуникации
- Еженедельный синк (понедельник) + демо (пятница).
- Каналы: Slack (#product, #engineering, #ai), Linear/Jira для задач, Notion для документации.
- Статус апдейты для пилотов: письмо по пятницам с прогрессом и roadmap.

## 7. Первые действия (Day 0–3)
1. Перенести репо вне OneDrive, убедиться, что `npm run build` и `npm run dev` работают.
2. Починить импорты и типы (см. ошибки `check-types`).
3. Создать `docs/ARCHITECTURE.md` с описанием потоков данных.
4. Настроить базовый smoke-тест (`apps/web/tests/smoke.spec.ts`).
5. Забронить слоты с 10 пилотами → отправить форму онбординга.

## 8. Готовность к релизу (Definition of Done)
- Пройден чек-лист тестов (smoke, e2e, AI-валидация, Stripe sandbox).
- Обновлены README и onboarding-гайды.
- Есть демо-видео, лендинг, FAQ.
- Единая схема аналитики: события пишутся, дашборд отображает данные.
- Поддержка: настроен Slack/Email, назначены ответственные.

> План подлежит еженедельному пересмотру после ретроспективы и обновления риск-реестра.
